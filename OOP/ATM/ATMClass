import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class ATM {
    private Map<String, String> dictOfAccounts;
    private float balance;
    Scanner sc = new Scanner(System.in);

    public ATM(float balance){
        this.balance = balance;
        dictOfAccounts = new HashMap<>();

        dictOfAccounts.put("20345", "0000");
        dictOfAccounts.put("83751", "4466");
        dictOfAccounts.put("48219", "1121");

    }
    public void showBalance(){
        System.out.println("You have " + balance + "EUR on your account");
        selectWhatToDo();
    }

    public void withdrawMoney(){
        System.out.println("Please enter the sum you'd like to withdraw from your account: ");
        float sum = sc.nextFloat();
        if (sum <= balance){
            balance = balance - sum;
            System.out.println("You've successfully withdrawn " + sum + "EUR from your account.");
        }
        else {
            System.out.println("You don't have enough money for this operation");
        }
        selectWhatToDo();
    }

    public void depositMoney(){
        System.out.println("Please enter the sum you'd like to put on your account: ");
        float sum = sc.nextFloat();
        if (sum > 0){
            balance = balance + sum;
            System.out.println("You've successfully put " + sum + "EUR to your account.");
        }
        else {
            System.out.println("You can't put that amount of money on your account");
        }
        selectWhatToDo();
    }

    public void selectWhatToDo() {
        System.out.println("\nWhat would you like to do? Type the number:");
        System.out.println("1. Check balance");
        System.out.println("2. Withdraw money");
        System.out.println("3. Deposit money");
        System.out.println("4. Log out");

        int selectedAction = sc.nextInt();
        switch (selectedAction) {
            case 1 -> showBalance();
            case 2 -> withdrawMoney();
            case 3 -> depositMoney();
            case 4 -> System.out.println("Thank you! Logging out.");
            default -> {
                System.out.println("Invalid selection. Try again.");
                selectWhatToDo();
            }
        }
    }

    public void checkCredentials() {
        try {
            System.out.println("Please enter the id number of your account: ");
            String accountID = sc.nextLine();
            System.out.println("Please enter the pin from your account: ");
            String pin = sc.nextLine();
            if (dictOfAccounts.containsKey(accountID) && dictOfAccounts.get(accountID).equals(pin)) {
                System.out.println("Login successfull!");
                selectWhatToDo();
            } else {
                System.out.println("The system couldn't recognize your account or the password is incorrect. Please verify your data.");
                checkCredentials();
            }
        } catch (Exception e) {
            System.out.println("Exception: " + e);
        }
    }

    public static void main(String[] args) {
        ATM atm = new ATM(1000);
        atm.checkCredentials();
    }
}
